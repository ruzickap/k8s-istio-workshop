(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{248:function(a,s,t){a.exports=t.p+"assets/img/istio.a24267ed.svg"},307:function(a,s){a.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAG8AAAAsCAIAAADka3H1AAAACXBIWXMAAA7EAAAOxAGVKw4bAAAFRUlEQVRoge2XX0hTbRjAn3OOtKOzzXnmQo+a25mLiY0hIRqSmTBQYUhgiTHwoi7Dq278F4R4IaK33TXwpoJs7FhGISKSQdT0IpcQbmf+iZbTsTzq2PTYxfm+fX7usy/3vau+73t/V4ftfZ73eX7b++cQ8XgcMIggf3YB/ymwTZRgmyjBNlGCbaIE20TJr27T6/X29fX97Cq+FyJN983h4eG1tbXf5iAIlUplNpttNhtN08fKs7W1FQqFTp8+nYYa/yAejz979uzdu3exWIxl2cbGxoKCghTyZCCvLEFdXV1lZSUASJIUCoV4nhdFsa2t7VhJlEqlUqlMT4EAAJIkkSQ5NjYWCASuXbumVCpfvHgxMjJy69Ytkjz2wk2jTZqm1Wq1/KzRaGw228OHD+Xqw+Gw2+32+/00TZtMpqamJkmS+vv729vbOY6TQ+7evavX64uKikZHR7u7uwEgOUoUxaGhoa6urqysLEmS7ty5U1FRYbfbAWBmZmZ+fv7GjRs+n+/p06dra2sqlaqysrKmpoYgiCdPnkSj0Z2dHUEQuru7CYKw2+3FxcUAYLPZBgcHw+EwwzDHbfnH7ZskSUqStL+/DwD3799nGKazs/PmzZtfvnzheT4zM7O0tNTr9cqDNzc3l5eXLRbLwQzJUQzDqNXq5eVlAFhdXc3JyREEQR4sCALHcaIojoyMXLhw4fbt2w6H49WrV7OzswBAUdSHDx8MBkNHRwcANDc3GwyGxNQZGRnZ2dmp9JiamuOysbExOTlpMpkoilpZWfn48WNDQ8OJEyeUSmV9ff3c3JwkSWfPnk3YnJ+fz8vLy8/PT2Q4KspgMAQCAQAQBKG8vHx7e3tnZwcAAoEAx3Gzs7Msy1osFpIkdTpdVVWVx+ORE1IUdf78+ZMnTx6sMxqNulyu2tpahUKRQptpXOnPnz+fmJgAgP39/b29vTNnzly+fBkANjY29vb2enp6Dg6ORCJlZWWPHz9eXV1lWdbr9R76Yx4VxXHcmzdvAMDv91dXVweDwaWlJYZhYrFYUVGRx+Px+XydnZ2JEI1GIz8kL+RIJOJ0OktKSi5dupRay39jU96wvofke0xNTc25c+cAIBAIuN3upqYm+TwhCIKm6d7e3uQkRqPR6/VqNBqfzydvfwmOiqIoyuVy7e7uLi0tXb16NRgM+v1+URT1ej1JkgRBmM1mh8ORPFdGxp96//Tpk9PprKqqunjx4ne2/Bc5v/31P7nrZWVlyb8/wzALCwuPHj26fv06QRC5ubnRaDQSichnVCwWi8fjsmiLxTI9Pa3VavPz87Va7cFsR0WpVCq1Wu3xeHJychQKRXFx8fj4+NbWlnyaabXaxcXFRBJRFGmaPuQRAMLh8L179xoaGqxWa8r9wg/bN+12ezAYfPnyJQCwLFtYWMjz/Pb2djQadbvdDx48kIeZzeZQKPT27dtDy/zbUQaDYWZmRr6Tsiz7+fNnQRCMRiMAWK3Wzc3Nqamp3d3dcDjsdDqnp6eTy+N5nuM4vV4f+Z3UruFp3DcPkp2d3djY6HK5TCaTTqdrbW3leX5gYIAkSY7jrly5Ig9TKBSlpaXv379vaWlJTnJUlNFofP36dX19PQBQFKXT6dbX10+dOiXP63A4xsfHJyYmMjMzrVZrbW3tobSxWGxhYQEA5ubmEh+2tbWVl5cft810vQv9P/nV39P/XWCbKME2UYJtogTbRAm2iRJsEyXYJkqwTZRgmyjBNlGCbaIE20QJtokSbBMl2CZKsE2UYJsowTZRgm2iBNtECbaJEmwTJdgmSrBNlHwFGGA5ftmDV+4AAAAASUVORK5CYII="},308:function(a,s){a.exports="data:image/png;base64,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"},309:function(a,s){a.exports="data:image/png;base64,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"},310:function(a,s,t){a.exports=t.p+"assets/img/bookinfo_v1_v3_v2.d76ff3b4.gif"},311:function(a,s,t){a.exports=t.p+"assets/img/istio_kiali_graph.5f2d46a7.gif"},337:function(a,s,t){"use strict";t.r(s);var e=t(8),r=Object(e.a)({},(function(){var a=this,s=a._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("h1",{attrs:{id:"istio-bookinfo-application"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#istio-bookinfo-application"}},[a._v("#")]),a._v(" Istio - Bookinfo Application")]),a._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[a._v("TIP")]),a._v(" "),s("p",[a._v("Screencast: "),s("a",{attrs:{href:"https://asciinema.org/a/229605?autoplay=0&t=352",target:"_blank",rel:"noopener noreferrer"}},[a._v("https://asciinema.org/a/229605?t=352"),s("OutboundLink")],1)])]),a._v(" "),s("p",[a._v("The Bookinfo application is broken into four separate microservices:")]),a._v(" "),s("ul",[s("li",[s("code",[a._v("productpage")]),a._v(" - the productpage microservice calls the details and reviews\nmicroservices to populate the page.")]),a._v(" "),s("li",[s("code",[a._v("details")]),a._v(" - the details microservice contains book information.")]),a._v(" "),s("li",[s("code",[a._v("reviews")]),a._v(" - the reviews microservice contains book reviews. It also calls\nthe ratings microservice.")]),a._v(" "),s("li",[s("code",[a._v("ratings")]),a._v(" - the ratings microservice contains book ranking information\nthat accompanies a book review.")])]),a._v(" "),s("p",[a._v("There are 3 versions of the "),s("code",[a._v("reviews")]),a._v(" microservice:")]),a._v(" "),s("ul",[s("li",[s("p",[a._v("Version "),s("code",[a._v("v1")]),a._v(" - doesn’t call the "),s("strong",[a._v("ratings service")]),a._v(".")]),a._v(" "),s("p",[s("img",{attrs:{src:t(307),alt:"Bookinfo v1",title:"Bookinfo v1"}})])]),a._v(" "),s("li",[s("p",[a._v("Version "),s("code",[a._v("v2")]),a._v(" - calls the ratings service, and displays each rating as 1 to 5\n"),s("strong",[a._v("black stars")]),a._v(".")]),a._v(" "),s("p",[s("img",{attrs:{src:t(308),alt:"Bookinfo v2",title:"Bookinfo v2"}})])]),a._v(" "),s("li",[s("p",[a._v("Version "),s("code",[a._v("v3")]),a._v(" - calls the ratings service, and displays each rating as 1 to 5\n"),s("strong",[a._v("red stars")]),a._v(".")]),a._v(" "),s("p",[s("img",{attrs:{src:t(309),alt:"Bookinfo v3",title:"Bookinfo v3"}})])])]),a._v(" "),s("p",[s("a",{attrs:{href:"https://istio.io/docs/examples/bookinfo/",target:"_blank",rel:"noopener noreferrer"}},[a._v("Bookinfo"),s("OutboundLink")],1),a._v(" application architecture:")]),a._v(" "),s("p",[s("img",{attrs:{src:"https://raw.githubusercontent.com/istio/istio.io/7bf371365e4a16a9a13c0e79355fe1eac7f8f99f/content/docs/examples/bookinfo/withistio.svg?sanitize=true",alt:"Application Architecture with Istio",title:"Application Architecture with Istio"}})]),a._v(" "),s("p",[a._v("Deploy the demo of "),s("a",{attrs:{href:"https://istio.io/docs/examples/bookinfo/",target:"_blank",rel:"noopener noreferrer"}},[a._v("Bookinfo"),s("OutboundLink")],1),a._v(" application:")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("kubectl apply "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-f")]),a._v(" samples/bookinfo/platform/kube/bookinfo.yaml\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sleep")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("400")]),a._v("\n")])])]),s("hr"),a._v(" "),s("p",[a._v("Confirm all services and pods are correctly defined and running:")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("kubectl get svc,deployment,pods "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-o")]),a._v(" wide\n")])])]),s("p",[a._v("Output:")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("NAME                  TYPE        CLUSTER-IP       EXTERNAL-IP   PORT"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("S"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("    AGE     SELECTOR\nservice/details       ClusterIP   "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("10.103")]),a._v(".142.153   "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("none"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("        "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("9080")]),a._v("/TCP   4m21s   "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("app")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("details\nservice/kubernetes    ClusterIP   "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("10.96")]),a._v(".0.1        "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("none"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("        "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("443")]),a._v("/TCP    75m     "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("none"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("\nservice/productpage   ClusterIP   "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("10.111")]),a._v(".62.53     "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("none"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("        "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("9080")]),a._v("/TCP   4m17s   "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("app")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("productpage\nservice/ratings       ClusterIP   "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("10.110")]),a._v(".22.215    "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("none"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("        "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("9080")]),a._v("/TCP   4m20s   "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("app")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("ratings\nservice/reviews       ClusterIP   "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("10.100")]),a._v(".73.81     "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("none"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("        "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("9080")]),a._v("/TCP   4m19s   "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("app")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("reviews\n\nNAME                                   READY   UP-TO-DATE   AVAILABLE   AGE     CONTAINERS    IMAGES                                         SELECTOR\ndeployment.extensions/details-v1       "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v("/1     "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v("            "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v("           4m21s   details       istio/examples-bookinfo-details-v1:1.8.0       "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("app")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("details,version"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("v1\ndeployment.extensions/productpage-v1   "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v("/1     "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v("            "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v("           4m16s   productpage   istio/examples-bookinfo-productpage-v1:1.8.0   "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("app")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("productpage,version"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("v1\ndeployment.extensions/ratings-v1       "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v("/1     "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v("            "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v("           4m20s   ratings       istio/examples-bookinfo-ratings-v1:1.8.0       "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("app")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("ratings,version"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("v1\ndeployment.extensions/reviews-v1       "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v("/1     "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v("            "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v("           4m19s   reviews       istio/examples-bookinfo-reviews-v1:1.8.0       "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("app")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("reviews,version"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("v1\ndeployment.extensions/reviews-v2       "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v("/1     "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v("            "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v("           4m18s   reviews       istio/examples-bookinfo-reviews-v2:1.8.0       "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("app")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("reviews,version"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("v2\ndeployment.extensions/reviews-v3       "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v("/1     "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v("            "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v("           4m18s   reviews       istio/examples-bookinfo-reviews-v3:1.8.0       "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("app")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("reviews,version"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("v3\n\nNAME                                      READY   STATUS    RESTARTS   AGE     IP            NODE                             NOMINATED NODE   READINESS GATES\npod/details-v1-68c7c8666d-pvrx6           "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),a._v("/2     Running   "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v("          4m21s   "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("10.244")]),a._v(".1.20   pruzicka-k8s-istio-workshop-node03   "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("none"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("           "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("none"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("\npod/elasticsearch-operator-sysctl-297j8   "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v("/1     Running   "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v("          45m     "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("10.244")]),a._v(".2.8    pruzicka-k8s-istio-workshop-node02   "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("none"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("           "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("none"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("\npod/elasticsearch-operator-sysctl-bg8rn   "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v("/1     Running   "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v("          45m     "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("10.244")]),a._v(".1.10   pruzicka-k8s-istio-workshop-node03   "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("none"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("           "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("none"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("\npod/elasticsearch-operator-sysctl-vwvbl   "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v("/1     Running   "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v("          45m     "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("10.244")]),a._v(".0.8    pruzicka-k8s-istio-workshop-node01   "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("none"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("           "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("none"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("\npod/productpage-v1-54d799c966-2b4ss       "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),a._v("/2     Running   "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v("          4m16s   "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("10.244")]),a._v(".1.23   pruzicka-k8s-istio-workshop-node03   "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("none"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("           "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("none"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("\npod/ratings-v1-8558d4458d-ln99n           "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),a._v("/2     Running   "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v("          4m20s   "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("10.244")]),a._v(".1.21   pruzicka-k8s-istio-workshop-node03   "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("none"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("           "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("none"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("\npod/reviews-v1-cb8655c75-hpqfg            "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),a._v("/2     Running   "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v("          4m19s   "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("10.244")]),a._v(".1.22   pruzicka-k8s-istio-workshop-node03   "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("none"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("           "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("none"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("\npod/reviews-v2-7fc9bb6dcf-snshx           "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),a._v("/2     Running   "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v("          4m18s   "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("10.244")]),a._v(".2.19   pruzicka-k8s-istio-workshop-node02   "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("none"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("           "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("none"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("\npod/reviews-v3-c995979bc-wcql9            "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),a._v("/2     Running   "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v("          4m18s   "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("10.244")]),a._v(".0.12   pruzicka-k8s-istio-workshop-node01   "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("none"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("           "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("none"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("\n")])])]),s("p",[a._v("Check the container details - you should see also container "),s("code",[a._v("istio-proxy")]),a._v(" next\nto "),s("code",[a._v("productpage")]),a._v(".")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("kubectl describe pod "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-l")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("app")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("productpage\n")])])]),s("p",[a._v("Output:")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),a._v(".\nContainers:\n  productpage:\n    Container ID:   docker://09597863ee7cdde548ddc1fe1990eed0fea4c28ca7d7a0aedc58af6918edafd6\n    Image:          istio/examples-bookinfo-productpage-v1:1.8.0\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),a._v(".\n  istio-proxy:\n    Container ID:  docker://7c411ca50317c307ac326e3dd27a598ff4fd00e53206f15acd8debf5e7b319d8\n    Image:         docker.io/istio/proxyv2:1.0.5\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),a._v(".\n")])])]),s("p",[a._v("The "),s("code",[a._v("kubectl logs")]),a._v(" command will show you the output of the envoy proxy:")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("kubectl logs "),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$(")]),a._v("kubectl get pod "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-l")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("app")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("productpage "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-o")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("jsonpath")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"{.items[0].metadata.name}"')]),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v(")")])]),a._v(" istio-proxy\n")])])]),s("p",[a._v("Output:")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2019")]),a._v("-02-21T08:23:21.009428Z     info    Version root@6f6ea1061f2b-docker.io/istio-1.0.5-c1707e45e71c75d74bf3a5dec8c7086f32f32fad-Clean\n"),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2019")]),a._v("-02-21T08:23:21.009468Z     info    Proxy role: model.Proxy"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("ClusterID:"),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('""')]),a._v(", Type:"),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"sidecar"')]),a._v(", IPAddress:"),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"10.244.0.14"')]),a._v(", ID:"),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"productpage-v1-54d799c966-vbm6k.default"')]),a._v(", Domain:"),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"default.svc.cluster.local"')]),a._v(", Metadata:map"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("string"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("string"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("nil"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2019")]),a._v("-02-21T08:23:21.009751Z     info    Effective config: binaryPath: /usr/local/bin/envoy\nconfigPath: /etc/istio/proxy\nconnectTimeout: 10s\ndiscoveryAddress: istio-pilot.istio-system:15007\ndiscoveryRefreshDelay: 1s\ndrainDuration: 45s\nparentShutdownDuration: 60s\nproxyAdminPort: "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("15000")]),a._v("\nserviceCluster: productpage\nzipkinAddress: zipkin.istio-system:9411\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),a._v(".\n")])])]),s("p",[a._v("Define the "),s("a",{attrs:{href:"https://istio.io/docs/reference/config/networking/gateway/",target:"_blank",rel:"noopener noreferrer"}},[a._v("Istio gateway"),s("OutboundLink")],1),a._v("\nfor the application:")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("cat")]),a._v(" samples/bookinfo/networking/bookinfo-gateway.yaml\nkubectl apply "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-f")]),a._v(" samples/bookinfo/networking/bookinfo-gateway.yaml\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sleep")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("5")]),a._v("\n")])])]),s("p",[a._v("Output:")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("apiVersion: networking.istio.io/v1alpha3\nkind: Gateway\nmetadata:\n  name: bookinfo-gateway\nspec:\n  selector:\n    istio: ingressgateway "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# use istio default controller")]),a._v("\n  servers:\n  - port:\n      number: "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("80")]),a._v("\n      name: http\n      protocol: HTTP\n    hosts:\n    - "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"*"')]),a._v("\n---\napiVersion: networking.istio.io/v1alpha3\nkind: VirtualService\nmetadata:\n  name: bookinfo\nspec:\n  hosts:\n  - "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"*"')]),a._v("\n  gateways:\n  - bookinfo-gateway\n  http:\n  - match:\n    - uri:\n        exact: /productpage\n    - uri:\n        exact: /login\n    - uri:\n        exact: /logout\n    - uri:\n        prefix: /api/v1/products\n    route:\n    - destination:\n        host: productpage\n        port:\n          number: "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("9080")]),a._v("\n")])])]),s("p",[a._v("Confirm the gateway and virtualsevice has been created:")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("kubectl get gateway,virtualservice\n")])])]),s("p",[a._v("Output:")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("NAME                                           AGE\ngateway.networking.istio.io/bookinfo-gateway   11s\n\nNAME                                          AGE\nvirtualservice.networking.istio.io/bookinfo   12s\n")])])]),s("p",[a._v("Determining the ingress IP and ports when using a node port:")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("export")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("INGRESS_PORT")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$(")]),a._v("kubectl "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-n")]),a._v(" istio-system get "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("service")]),a._v(" istio-ingressgateway "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-o")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("jsonpath")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"{.spec.ports[?(@.name=='),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[a._v('\\"')]),a._v("http2"),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[a._v('\\"')]),a._v(')].nodePort}"')]),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v(")")])]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("export")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("SECURE_INGRESS_PORT")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$(")]),a._v("kubectl "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-n")]),a._v(" istio-system get "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("service")]),a._v(" istio-ingressgateway "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-o")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("jsonpath")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"{.spec.ports[?(@.name=='),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[a._v('\\"')]),a._v("https"),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[a._v('\\"')]),a._v(')].nodePort}"')]),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v(")")])]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("export")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("INGRESS_HOST")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$(")]),a._v("kubectl get po "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-l")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("istio")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("ingressgateway "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-n")]),a._v(" istio-system "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-o")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"jsonpath={.items[0].status.hostIP}"')]),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v(")")])]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("if")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("test")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-f")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),a._v("/"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),a._v("/terraform.tfstate "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("&&")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("grep")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-q")]),a._v(" vms_public_ip "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),a._v("/"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),a._v("/terraform.tfstate"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("then")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("export")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("INGRESS_HOST")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$(")]),a._v("terraform output "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-json")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-state")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),a._v("/"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),a._v("/terraform.tfstate "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" jq "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-r")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('".vms_public_ip.value[0]"')]),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v(")")])]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("fi")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("export")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("GATEWAY_URL")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$INGRESS_HOST")]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$INGRESS_PORT")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("echo")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"'),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$INGRESS_PORT")]),a._v(" | "),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$SECURE_INGRESS_PORT")]),a._v(" | "),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$INGRESS_HOST")]),a._v(" | "),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$GATEWAY_URL")]),a._v(" | http://"),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$GATEWAY_URL")]),a._v('/productpage"')]),a._v("\n")])])]),s("p",[a._v("Output:")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token number"}},[a._v("31380")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("31390")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("172.16")]),a._v(".242.170 "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("172.16")]),a._v(".242.170:31380 "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" http://172.16.242.170:31380/productpage\n")])])]),s("p",[a._v("Point your browser to "),s("code",[a._v("http://$GATEWAY_URL/productpage")]),a._v("\n(take the full URL from the output of the commands above).")]),a._v(" "),s("hr"),a._v(" "),s("p",[a._v("Confirm the app is running:")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("curl")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-o")]),a._v(" /dev/null "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-s")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-w")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"%{http_code}'),s("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[a._v("\\n")]),a._v('"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-A")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"Mozilla/5.0 (iPhone; U; CPU iPhone OS 4_3_3 like Mac OS X; en-us) AppleWebKit/533.17.9 (KHTML, like Gecko) Version/5.0.2 Mobile/8J2 Safari/6533.18.5"')]),a._v(" http://"),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${GATEWAY_URL}")]),a._v("/productpage\n")])])]),s("p",[a._v("Output:")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token number"}},[a._v("200")]),a._v("\n")])])]),s("p",[a._v("Create default "),s("a",{attrs:{href:"https://istio.io/docs/reference/config/networking/destination-rule/",target:"_blank",rel:"noopener noreferrer"}},[a._v("destination rules"),s("OutboundLink")],1),a._v("\n(subsets) for the Bookinfo services:")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("kubectl apply "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-f")]),a._v(" samples/bookinfo/networking/destination-rule-all.yaml\n")])])]),s("p",[a._v("Display the destination rules:")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("kubectl get destinationrules "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-o")]),a._v(" yaml\n")])])]),s("p",[a._v("Output:")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),a._v(".\n- apiVersion: networking.istio.io/v1alpha3\n  kind: DestinationRule\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),a._v(".\n    name: reviews\n    namespace: default\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),a._v(".\n  spec:\n    host: reviews\n    subsets:\n    - labels:\n        version: v1\n      name: v1\n    - labels:\n        version: v2\n      name: v2\n    - labels:\n        version: v3\n      name: v3\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),a._v(".\n")])])]),s("p",[a._v("Generate some traffic for next 5 minutes to gather some data:")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("siege "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--log")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("/tmp/siege "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--concurrent")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-q")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--internet")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--time")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("5M "),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$GATEWAY_URL")]),a._v("/productpage "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("&")]),a._v("\n")])])]),s("p",[a._v("Open the browser with these pages:")]),a._v(" "),s("ul",[s("li",[s("p",[a._v("Servicegraph:")]),a._v(" "),s("ul",[s("li",[s("p",[s("a",{attrs:{href:"http://localhost:8088/force/forcegraph.html",target:"_blank",rel:"noopener noreferrer"}},[a._v("http://localhost:8088/force/forcegraph.html"),s("OutboundLink")],1)])]),a._v(" "),s("li",[s("p",[s("a",{attrs:{href:"http://localhost:8088/dotviz",target:"_blank",rel:"noopener noreferrer"}},[a._v("http://localhost:8088/dotviz"),s("OutboundLink")],1)])])])]),a._v(" "),s("li",[s("p",[s("a",{attrs:{href:"https://www.kiali.io/",target:"_blank",rel:"noopener noreferrer"}},[a._v("Kiali"),s("OutboundLink")],1),a._v(":")]),a._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"http://localhost:20001",target:"_blank",rel:"noopener noreferrer"}},[a._v("http://localhost:20001"),s("OutboundLink")],1),a._v(" (admin/admin)")])])]),a._v(" "),s("li",[s("p",[s("a",{attrs:{href:"https://www.jaegertracing.io/",target:"_blank",rel:"noopener noreferrer"}},[a._v("Jaeger"),s("OutboundLink")],1),a._v(":")]),a._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"http://localhost:16686",target:"_blank",rel:"noopener noreferrer"}},[a._v("http://localhost:16686"),s("OutboundLink")],1)])])]),a._v(" "),s("li",[s("p",[s("a",{attrs:{href:"https://prometheus.io/",target:"_blank",rel:"noopener noreferrer"}},[a._v("Prometheus"),s("OutboundLink")],1),a._v(":")]),a._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"http://localhost:9090/graph",target:"_blank",rel:"noopener noreferrer"}},[a._v("http://localhost:9090/graph"),s("OutboundLink")],1)])])]),a._v(" "),s("li",[s("p",[s("a",{attrs:{href:"https://www.elastic.co/products/kibana",target:"_blank",rel:"noopener noreferrer"}},[a._v("Kibana"),s("OutboundLink")],1),a._v(":")]),a._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://localhost:5601/app/kibana",target:"_blank",rel:"noopener noreferrer"}},[a._v("https://localhost:5601/app/kibana"),s("OutboundLink")],1)])])]),a._v(" "),s("li",[s("p",[s("a",{attrs:{href:"https://grafana.com/",target:"_blank",rel:"noopener noreferrer"}},[a._v("Grafana"),s("OutboundLink")],1),a._v(":")]),a._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"http://localhost:3000",target:"_blank",rel:"noopener noreferrer"}},[a._v("http://localhost:3000"),s("OutboundLink")],1),a._v(" (Grafana -> Home -> Istio ->\nIstio Performance Dashboard, Istio Service Dashboard,\nIstio Workload Dashboard)")])])])]),a._v(" "),s("p",[a._v("Open the Bookinfo site in your browser "),s("code",[a._v("http://$GATEWAY_URL/productpage")]),a._v("\nand refresh the page several times - you should see different versions\nof reviews shown in productpage, presented in a "),s("strong",[a._v("round robin style")]),a._v("\n(red stars, black stars, no stars), since we haven’t yet used Istio to control\nthe version routing.")]),a._v(" "),s("p",[s("img",{attrs:{src:t(310),alt:"Bookinfo v1, v3, v2",title:"Bookinfo v1, v3, v2"}})]),a._v(" "),s("p",[a._v("Check the flows in "),s("a",{attrs:{href:"https://www.kiali.io/",target:"_blank",rel:"noopener noreferrer"}},[a._v("Kiali"),s("OutboundLink")],1),a._v(" graph:")]),a._v(" "),s("p",[s("img",{attrs:{src:t(311),alt:"Istio Graph",title:"Istio Graph"}})]),a._v(" "),s("hr"),a._v(" "),s("p",[s("img",{attrs:{src:t(248),alt:"Istio",title:"Istio"}})])])}),[],!1,null,null,null);s.default=r.exports}}]);